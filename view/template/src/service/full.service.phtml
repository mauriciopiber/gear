namespace <?php echo $this->module;?>\Service;

use <?php echo $this->module;?>\Service\AbstractService;
<?php echo $this->partialLoop('template/miscellaneous/use-partial.phtml', $this->use);?>

class <?php echo $this->class;?> extends <?php echo $this->extends.PHP_EOL;?>
{
<?php echo $this->partialLoop('template/miscellaneous/attribute-partial.phtml', $this->attribute);?>

    public function selectById($id)
    {
        $repository = $this->get<?php echo $this->repository;?>();
        return $repository->selectById($id);
    }

    public function selectAll()
    {
        $repository = $this->get<?php echo $this->repository;?>();
        return $repository->selectAll();
    }

<?php if ($this->imagemService) :?>
    public function create($data, $post)
<?php else :?>
    public function create($data)
<?php endif;?>
    {
        $repository = $this->get<?php echo $this->repository;?>();
        $<?= $this->str('var', $this->baseName)?> = $repository->insert($data);
<?php if ($this->imagemService) :?>
        $imagemService = $this->getImagemService();
        $imagemService->updateImages('<?= $this->str('url', $this->baseName)?>', $<?= $this->str('var', $this->baseName)?>->getId<?= $this->str('class', $this->baseName)?>());
        $imagemService->updatePosition($post);
<?php endif;?>
        return $<?= $this->str('var', $this->baseName)?>;

    }

<?php if ($this->imagemService) :?>
    public function update($idTable, $data = array(), $post = array())
<?php else :?>
    public function update($idTable, $data = array())
<?php endif;?>
    {
        $repository = $this->get<?php echo $this->repository;?>();
        $<?= $this->str('var', $this->baseName)?> = $repository->update($idTable, $data);
<?php if ($this->imagemService) :?>
        $imagemService = $this->getImagemService();
        $imagemService->updateImages('<?= $this->str('url', $this->baseName)?>', $<?= $this->str('var', $this->baseName)?>->getId<?= $this->str('class', $this->baseName)?>());
        $imagemService->updatePosition($post);
<?php endif;?>
        return $<?= $this->str('var', $this->baseName)?>;
    }

    public function delete($idTable)
    {
        $repository = $this->get<?php echo $this->repository;?>();
        $<?= $this->str('var', $this->baseName)?> = $repository->delete($idTable);

<?php if ($this->imagemService) :?>
        $imagemService = $this->getImagemService();
        $imagemService->deleteImages($idTable, '<?= $this->str('url', $this->baseName)?>');
<?php endif;?>

        return $<?= $this->str('var', $this->baseName)?>;
    }

<?php if ($this->imagemService) :?>
    public function getImagemService()
    {
        if (!isset($this->imagemService)) {
            $this->imagemService =
            $this->getServiceLocator()->get('ImagemUpload\Service\ImagemService');
        }
        return $this->imagemService;
    }
<?php endif;?>

<?php echo $this->partialLoop('template/miscellaneous/injection-partial.phtml', $this->injection);?>
}

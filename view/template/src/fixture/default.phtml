namespace <?php echo $this->module;?>\Fixture;

use Doctrine\Common\Persistence\ObjectManager;
use Doctrine\Common\DataFixtures\FixtureInterface;
use Doctrine\Common\DataFixtures\AbstractFixture;
use Doctrine\Common\DataFixtures\OrderedFixtureInterface;

class <?php echo $this->name;?> extends AbstractFixture implements
    FixtureInterface,
    OrderedFixtureInterface
{
<?php echo $this->userlaw.PHP_EOL;?>
    public function load(ObjectManager $manager)
    {
        $this->manager = $manager;


        foreach ($this->getFixture() as $i => $fixture) {

            $reference = $i+1;

            $<?php echo $this->str('var', str_replace('Fixture', '', $this->name));?> = new \<?php echo $this->module?>\Entity\<?php echo str_replace('Fixture', '', $this->name);?>();
<?php foreach ($this->fields as $field):?>
<?php echo $field.PHP_EOL;?>
<?php endforeach;?>
            $user = $this->getReferenceToEntity();
            $<?php echo $this->str('var', str_replace('Fixture', '', $this->name));?>->setCreated(new \DateTime('now'));
            $<?php echo $this->str('var', str_replace('Fixture', '', $this->name));?>->setCreatedBy($user);
            $this->manager->persist($<?php echo $this->str('var', str_replace('Fixture', '', $this->name));?>);
            $this->manager->flush();
            $this->addReference("<?php echo $this->str('url', str_replace('Fixture', '', $this->name)); ?>-$reference", $<?php echo $this->str('var', str_replace('Fixture', '', $this->name))?>);
        }

    }



    public function getFixture()
    {
        return array(
<?php foreach ($this->data as $item):?>
<?php echo $item;?>
<?php endforeach;?>

        );

    }


            //1 - 5 = 1
            //6 - 10 = 2
            //11 - 15 = 3
            //16 - 20 = 4
            //21 - 25 = 5
            //26 - 30 = 6
    public function getReferenceToEntity($referenced = 1)
    {
        //aqui fica o view que você não sabe como
        //fazer e vai aprender a fazer a merda do child view pra nao fazer gambiarra a porra da vida toda.


        $referenced = sprintf('usuariogear%d', $referenced);

        $userId = $this->getReference($referenced);
        return $this->manager->getRepository('<?php echo $this->module?>\Entity\User')->findOneBy(array('idUser' => $userId->getIdUser()));
    }

    public function getOrder()
    {
        return <?php echo $this->order;?>;
    }
}

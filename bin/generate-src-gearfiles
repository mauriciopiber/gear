#!/usr/bin/env php
<?php


chdir(dirname(__DIR__));

// Decline static file requests back to the PHP built-in webserver
if (php_sapi_name() === 'cli-server') {
    $path = realpath(__DIR__ . parse_url($_SERVER['REQUEST_URI'***REMOVED***, PHP_URL_PATH));
    if (__FILE__ !== $path && is_file($path)) {
        return false;
    }
    unset($path);
}


// Setup autoloading
require __DIR__.'/generate-functions';

$string = new GearBase\Util\String\StringService();

$columnUtil   = new Gear\Integration\Util\Columns\Columns();
$location     = new Gear\Integration\Util\Location\Location();
$persist      = new Gear\Integration\Util\Persist\Persist($location);

$gearfile = new Gear\Integration\Component\GearFile\GearFile(
    $persist,
    $string
);
    
$testFile = new Gear\Integration\Component\TestFile\TestFile($persist, $string);
        
$superTestFile = new Gear\Integration\Component\SuperTestFile\SuperTestFile($persist, $string);

$srcGenerator = new Gear\Integration\Suite\Src\SrcGenerator\SrcGenerator($gearfile, $testFile);

$srcSuite = new Gear\Integration\Suite\Src\SrcSuite\SrcSuite($srcGenerator, $superTestFile);


if (empty($argv[1***REMOVED***)) {
    return;
}

$string = new GearBase\Util\String\StringService();

$type = $string->str('class', $argv[1***REMOVED***);
$repeat = (!isset($argv[2***REMOVED***)) ? 1 : (($argv[2***REMOVED*** > 10 ) ? 10 : $argv[2***REMOVED***);


$srcSuite->runSrcSuite($type, $repeat);
return;
